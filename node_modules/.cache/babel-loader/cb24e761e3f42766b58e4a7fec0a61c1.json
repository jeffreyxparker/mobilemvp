{"ast":null,"code":"var _jsxFileName = \"/home/abdullah-faiz/mobilemvp/frontend/src/components/Survey.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport SurveyHeader from \"./SurveyHeader\";\nimport { Spinner } from \"react-bootstrap\";\nimport SurveyData from \"./SurveyData\";\nimport SurveySidebar from \"./Sidebar/SurveySidebar\";\nimport AlertModal from \"./Modal/AlertModal\";\nimport InfoModal from \"./Modal/InfoModal\";\nimport Successful from \"../components/Successful\";\nimport { useLocation } from \"react-router\";\nimport { Howl, Howler } from \"howler\";\nimport toast from \"react-hot-toast\";\nimport axios from \"axios\";\nimport AlertSound from \"../assets/sounds/Alert.mp3\";\nimport useStickyState from \"../hooks/useStickyState\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Survey = () => {\n  _s();\n\n  const params = new URLSearchParams(useLocation().search);\n  const RID = params.get(\"RID\");\n  const [localSurveyData, setLocalSurveyData] = useStickyState([], `survey_data${RID}`);\n  const [localCartData] = useStickyState([], `cart_data${RID}`);\n  const [localThankYouPage, setLocalThankYouPage] = useStickyState(false, `thank_you_page${RID}`);\n  const [localDefaultData] = useStickyState([], `default_data${RID}`);\n  const [, setLocalTimer] = useStickyState(0, `timer${RID}`);\n  const [localTimerCount, setLocalTimerCount] = useStickyState(0, `timer_count${RID}`);\n  const [fetchedData, setFetchedData] = useState([]);\n  const [, setDefaultData] = useState(localDefaultData);\n  const [surveyData, setSurveyData] = useState(localSurveyData);\n  const [cartData, setCartData] = useState(localCartData);\n  const [timer, setTimer] = useState(0);\n  const [showThankyouPage, setShowThankyouPage] = useState(localThankYouPage);\n  const [toggleSidebar, setToggleSidebar] = useState(false);\n  const [showWarning, setShowWarning] = useState(false);\n  const [showInfoPopup, setShowInfoPopup] = useState(false);\n  const [showTimerAlert, setShowTimerAlert] = useState(false);\n  const [infoID, setInfoID] = useState(0);\n  const [, setStartTime] = useState();\n  const [, setEndTime] = useState();\n  const [buttonLoading, setButtonLoading] = useState(false);\n  sessionStorage.setItem(`userId${RID}`, RID);\n  useEffect(() => {\n    showTimerPopUp();\n\n    if (localSurveyData.length === 0) {\n      let formData = new FormData();\n      formData.append(\"rid\", RID);\n      fetch(process.env.REACT_APP_START_SURVEY_API, {\n        method: \"post\",\n        body: formData\n      }).then(res => res.json()).then(data => {\n        sessionStorage.setItem(`endtime${RID}`, JSON.stringify(new Date(data.body[0].time_started).setTime(new Date(data.body[0].time_started).getTime() + 600000)));\n        setFetchedData(data);\n        setStartTime(new Date(data.body[0].time_started).getTime());\n        setEndTime(new Date(data.body[0].time_started).setTime(new Date(data.body[0].time_started).getTime() + 600000));\n      }).catch(err => toast.error(err === null || err === void 0 ? void 0 : err.message));\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, []);\n  useEffect(() => {\n    if (fetchedData.length === 0) {} else if (fetchedData.message === \"rid is already used\") {\n      const lsd = sessionStorage.getItem(`survey_data${RID}`);\n      lsd !== null && setSurveyData(JSON.parse(localSurveyData));\n    } else {\n      let fetched_data = [{\n        id: fetchedData.body[0].market1[0].id,\n        question: \"Which Kodiak product will sell the most?\",\n        subtotal: 0,\n        options: [{\n          id: fetchedData.body[0].market1[0].option1.id,\n          name: \"Bacon, Egg and Cheese Biscuit Protein Breakfast Sandwich\",\n          price: fetchedData.body[0].market1[0].option1.price_1 ? fetchedData.body[0].market1[0].option1.price_1 : 0.0,\n          quantity: fetchedData.body[0].market1[0].option1.bet_1,\n          total: fetchedData.body[0].market1[0].option1.money_bet_1\n        }, {\n          id: fetchedData.body[0].market1[0].option2.id,\n          name: \"Kids Chocolate Blueberry Power Waffle\",\n          price: fetchedData.body[0].market1[0].option2.price_2 ? fetchedData.body[0].market1[0].option2.price_2 : 0.0,\n          quantity: fetchedData.body[0].market1[0].option2.bet_2,\n          total: fetchedData.body[0].market1[0].option2.money_bet_2\n        }, {\n          id: fetchedData.body[0].market1[0].option3.id,\n          name: \"High Protein Multi-Purpose Cake Flour\",\n          price: fetchedData.body[0].market1[0].option3.price_3 ? fetchedData.body[0].market1[0].option3.price_3 : 0.0,\n          quantity: fetchedData.body[0].market1[0].option3.bet_3,\n          total: fetchedData.body[0].market1[0].option3.money_bet_3\n        }, {\n          id: fetchedData.body[0].market1[0].option4.id,\n          name: \"Protein Power To-Go Bars\",\n          price: fetchedData.body[0].market1[0].option4.price_4 ? fetchedData.body[0].market1[0].option4.price_4 : 0.0,\n          quantity: fetchedData.body[0].market1[0].option4.bet_4,\n          total: fetchedData.body[0].market1[0].option4.money_bet_4\n        }]\n      }, {\n        id: fetchedData.body[0].market2[0].id,\n        question: \"Who will be the host of Jeopardy! for the next season?\",\n        subtotal: 0,\n        options: [{\n          id: fetchedData.body[0].market2[0].option1.id,\n          name: \"Ken Jennings\",\n          price: fetchedData.body[0].market2[0].option1.price_1 ? fetchedData.body[0].market2[0].option1.price_1 : 0.0,\n          quantity: fetchedData.body[0].market2[0].option1.bet_1,\n          total: fetchedData.body[0].market2[0].option1.money_bet_1\n        }, {\n          id: fetchedData.body[0].market2[0].option2.id,\n          name: \"LaVar Burton\",\n          price: fetchedData.body[0].market2[0].option2.price_2 ? fetchedData.body[0].market2[0].option2.price_2 : 0.0,\n          quantity: fetchedData.body[0].market2[0].option2.bet_2,\n          total: fetchedData.body[0].market2[0].option2.money_bet_2\n        }, {\n          id: fetchedData.body[0].market2[0].option3.id,\n          name: \"Aaron Rodgers\",\n          price: fetchedData.body[0].market2[0].option3.price_3 ? fetchedData.body[0].market2[0].option3.price_3 : 0.0,\n          quantity: fetchedData.body[0].market2[0].option3.bet_3,\n          total: fetchedData.body[0].market2[0].option3.money_bet_3\n        }, {\n          id: fetchedData.body[0].market2[0].option4.id,\n          name: \"Somebody else\",\n          price: fetchedData.body[0].market2[0].option4.price_4 ? fetchedData.body[0].market2[0].option4.price_4 : 0.0,\n          quantity: fetchedData.body[0].market2[0].option4.bet_4,\n          total: fetchedData.body[0].market2[0].option4.money_bet_4\n        }]\n      }, {\n        id: fetchedData.body[0].market3[0].id,\n        question: \"How many games will BYU’s football team win?\",\n        subtotal: 0,\n        options: [{\n          id: fetchedData.body[0].market3[0].option1.id,\n          name: \"6 or fewer\",\n          price: fetchedData.body[0].market3[0].option1.price_1 ? fetchedData.body[0].market3[0].option1.price_1 : 0.0,\n          quantity: fetchedData.body[0].market3[0].option1.bet_1,\n          total: fetchedData.body[0].market3[0].option1.money_bet_1\n        }, {\n          id: fetchedData.body[0].market3[0].option2.id,\n          name: \"7\",\n          price: fetchedData.body[0].market3[0].option2.price_2 ? fetchedData.body[0].market3[0].option2.price_2 : 0.0,\n          quantity: fetchedData.body[0].market3[0].option2.bet_2,\n          total: fetchedData.body[0].market3[0].option2.money_bet_2\n        }, {\n          id: fetchedData.body[0].market3[0].option3.id,\n          name: \"8\",\n          price: fetchedData.body[0].market3[0].option3.price_3 ? fetchedData.body[0].market3[0].option3.price_3 : 0.0,\n          quantity: fetchedData.body[0].market3[0].option3.bet_3,\n          total: fetchedData.body[0].market3[0].option3.money_bet_3\n        }, {\n          id: fetchedData.body[0].market3[0].option4.id,\n          name: \"9 or more\",\n          price: fetchedData.body[0].market3[0].option4.price_4 ? fetchedData.body[0].market3[0].option4.price_4 : 0.0,\n          quantity: fetchedData.body[0].market3[0].option4.bet_4,\n          total: fetchedData.body[0].market3[0].option4.money_bet_4\n        }]\n      }, {\n        id: fetchedData.body[0].market4[0].id,\n        question: \"Will upcoming James Bond film “No Time To Die” be “Certified Fresh” by Rotten Tomatoes?\",\n        subtotal: 0,\n        options: [{\n          id: fetchedData.body[0].market4[0].option1.id,\n          name: \"Yes\",\n          price: fetchedData.body[0].market4[0].option1.price_1 ? fetchedData.body[0].market4[0].option1.price_1 : 0.0,\n          quantity: fetchedData.body[0].market4[0].option1.bet_1,\n          total: fetchedData.body[0].market4[0].option1.money_bet_1\n        }, {\n          id: fetchedData.body[0].market4[0].option2.id,\n          name: \"No\",\n          price: fetchedData.body[0].market4[0].option2.price_2 ? fetchedData.body[0].market4[0].option2.price_2 : 0.0,\n          quantity: fetchedData.body[0].market4[0].option2.bet_2,\n          total: fetchedData.body[0].market4[0].option2.money_bet_2\n        }]\n      }];\n\n      const shuffle = () => {\n        return fetched_data.sort(() => Math.random() - 0.5);\n      };\n\n      const shuffled_fetched_data = shuffle();\n      setDefaultData(shuffled_fetched_data);\n      setSurveyData(shuffled_fetched_data);\n\n      if (shuffled_fetched_data.length > 0) {\n        sessionStorage.setItem(`default_data${RID}`, JSON.stringify(shuffled_fetched_data));\n      }\n\n      setLocalSurveyData(JSON.stringify(shuffled_fetched_data));\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [fetchedData, setFetchedData]);\n  sessionStorage.setItem(`survey_data${RID}`, JSON.stringify(surveyData));\n  sessionStorage.setItem(`userId${RID}`, JSON.stringify(RID));\n  sessionStorage.setItem(`cart_data${RID}`, JSON.stringify(cartData));\n  let totalPurchase;\n  let totalShares;\n\n  const playNotification = () => {\n    Howler.volume(1.0);\n    const sound = new Howl({\n      src: [AlertSound],\n      autoplay: true\n    });\n    sound.play();\n  };\n\n  const submitData = () => {\n    setToggleSidebar(true);\n    const l_cart_data = sessionStorage.getItem(`cart_data${RID}`);\n\n    if (l_cart_data !== null && JSON.parse(l_cart_data).length !== 0) {\n      const parse_l_cart_data = JSON.parse(l_cart_data);\n      let convertedData = {};\n      const marketIDs = parse_l_cart_data.map(market => market.id);\n      let marketData = [];\n\n      for (let d in marketIDs) {\n        let oneMarketData = surveyData === null || surveyData === void 0 ? void 0 : surveyData.find(obj => obj.id === marketIDs[d]);\n        marketData.push(oneMarketData);\n      }\n\n      let marketDataOptions = marketData.map(market => market === null || market === void 0 ? void 0 : market.options);\n\n      for (let d in marketData) {\n        const optId = marketDataOptions[d].map(m => m.id);\n        const optBet = marketDataOptions[d].map(m => m.quantity);\n        const optPrice = marketDataOptions[d].map(m => m.price);\n        let opts = [];\n\n        for (let i in optId) {\n          opts = [...opts, {\n            id: optId[i],\n            bet: optBet[i],\n            price: optPrice[i]\n          }];\n        }\n\n        let marketName = `market${parseInt(d) + 1}`;\n        convertedData = { ...convertedData,\n          [marketName]: {\n            id: marketIDs[d],\n            options: opts\n          }\n        };\n      }\n\n      convertedData = { ...convertedData,\n        rid: RID\n      };\n      axios.post(process.env.REACT_APP_END_SURVEY_API, JSON.stringify(convertedData), {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(res => {\n        var _res$data;\n\n        if ((res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.message) === \"success\") {\n          setShowThankyouPage(true);\n          setLocalThankYouPage(true);\n        } else {\n          var _res$data2;\n\n          toast.error(res === null || res === void 0 ? void 0 : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.message);\n        }\n\n        setButtonLoading(false);\n      }).catch(err => {\n        toast.error(err === null || err === void 0 ? void 0 : err.message);\n        setButtonLoading(false);\n      });\n    }\n  };\n\n  const showTimerPopUp = () => {\n    if (surveyData) {\n      const timeLimit = 480;\n      let i;\n      let count = localTimerCount;\n      const timer = setInterval(() => {\n        const localEndTime = sessionStorage.getItem(`endtime${RID}`);\n        const getLocalEndTime = localEndTime !== null && JSON.parse(localEndTime);\n        const localThankYou = sessionStorage.getItem(`thank_you_page${RID}`);\n        i = parseInt((600 - (getLocalEndTime - new Date().getTime()) / 1000).toString());\n\n        if (i === timeLimit && count === 0 && localThankYou !== null && !JSON.parse(localThankYou)) {\n          count++;\n          setLocalTimerCount(count);\n          setShowTimerAlert(true);\n          setShowWarning(true);\n          playNotification();\n        }\n\n        setTimer(i);\n        setLocalTimer(JSON.stringify(i));\n      }, 1000);\n    }\n  };\n\n  const showBalancePopup = () => {\n    setShowTimerAlert(false);\n    setShowWarning(true);\n    playNotification();\n  };\n\n  if (cartData) {\n    const optionsData = cartData.map(market => market.options);\n    optionsData.map(option => option);\n    const onlyOpt = Array.prototype.concat.apply([], optionsData.map(option => option));\n    const subtotalArr = onlyOpt.map(opt => opt.total);\n    const totalSharesArr = onlyOpt.map(opt => opt.quantity);\n    totalPurchase = parseFloat(subtotalArr.reduce((p, c) => p + c, 0).toFixed(2));\n    totalShares = totalSharesArr.reduce((p, c) => p + c, 0);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [!localThankYouPage && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app_background_overlay\",\n      onClick: () => setToggleSidebar(false),\n      style: {\n        display: toggleSidebar ? \"block\" : \"none\",\n        zIndex: 9\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"survey\",\n      children: surveyData.length !== 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(AlertModal, {\n          showWarning: showWarning,\n          setShowWarning: setShowWarning,\n          type: showTimerAlert ? \"time\" : \"balance\",\n          timer: timer,\n          toggleSidebar: toggleSidebar,\n          setToggleSidebar: setToggleSidebar\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(InfoModal, {\n          showInfoPopup: showInfoPopup,\n          setShowInfoPopup: setShowInfoPopup,\n          surveyData: surveyData,\n          infoID: infoID\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 13\n        }, this), !showThankyouPage ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(SurveySidebar, {\n            totalShares: totalShares,\n            totalPurchase: totalPurchase,\n            surveyData: surveyData,\n            setSurveyData: setSurveyData,\n            cartData: cartData,\n            setCartData: setCartData,\n            toggleSidebar: toggleSidebar,\n            setToggleSidebar: setToggleSidebar,\n            setShowThankyouPage: setShowThankyouPage,\n            submitData: submitData,\n            timer: timer,\n            setButtonLoading: setButtonLoading,\n            buttonLoading: buttonLoading\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(SurveyHeader, {\n            totalPurchase: totalPurchase,\n            toggleSidebar: toggleSidebar,\n            setToggleSidebar: setToggleSidebar,\n            timer: timer\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-center font-italic my-2\",\n            style: {\n              color: \"#727272\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"em\", {\n              children: \"Tap an option to purchase a share\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 467,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(SurveyData, {\n            showBalancePopup: showBalancePopup,\n            totalPurchase: totalPurchase,\n            surveyData: surveyData,\n            setSurveyData: setSurveyData,\n            cartData: cartData,\n            setCartData: setCartData,\n            showInfoPopup: showInfoPopup,\n            setShowInfoPopup: setShowInfoPopup,\n            setInfoID: setInfoID,\n            infoID: infoID\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex justify-content-center align-items-center w-100\",\n          style: {\n            height: \"100vh\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Successful, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-center align-items-center w-100\",\n        style: {\n          height: \"100vh\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Spinner, {\n          animation: \"border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 496,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Survey, \"P9tXsvp1sAeD5LHNWE5RTUoThY4=\", false, function () {\n  return [useLocation, useStickyState, useStickyState, useStickyState, useStickyState, useStickyState, useStickyState];\n});\n\n_c = Survey;\nexport default Survey;\n\nvar _c;\n\n$RefreshReg$(_c, \"Survey\");","map":{"version":3,"sources":["/home/abdullah-faiz/mobilemvp/frontend/src/components/Survey.tsx"],"names":["React","useEffect","useState","SurveyHeader","Spinner","SurveyData","SurveySidebar","AlertModal","InfoModal","Successful","useLocation","Howl","Howler","toast","axios","AlertSound","useStickyState","Survey","params","URLSearchParams","search","RID","get","localSurveyData","setLocalSurveyData","localCartData","localThankYouPage","setLocalThankYouPage","localDefaultData","setLocalTimer","localTimerCount","setLocalTimerCount","fetchedData","setFetchedData","setDefaultData","surveyData","setSurveyData","cartData","setCartData","timer","setTimer","showThankyouPage","setShowThankyouPage","toggleSidebar","setToggleSidebar","showWarning","setShowWarning","showInfoPopup","setShowInfoPopup","showTimerAlert","setShowTimerAlert","infoID","setInfoID","setStartTime","setEndTime","buttonLoading","setButtonLoading","sessionStorage","setItem","showTimerPopUp","length","formData","FormData","append","fetch","process","env","REACT_APP_START_SURVEY_API","method","body","then","res","json","data","JSON","stringify","Date","time_started","setTime","getTime","catch","err","error","message","lsd","getItem","parse","fetched_data","id","market1","question","subtotal","options","option1","name","price","price_1","quantity","bet_1","total","money_bet_1","option2","price_2","bet_2","money_bet_2","option3","price_3","bet_3","money_bet_3","option4","price_4","bet_4","money_bet_4","market2","market3","market4","shuffle","sort","Math","random","shuffled_fetched_data","totalPurchase","totalShares","playNotification","volume","sound","src","autoplay","play","submitData","l_cart_data","parse_l_cart_data","convertedData","marketIDs","map","market","marketData","d","oneMarketData","find","obj","push","marketDataOptions","optId","m","optBet","optPrice","opts","i","bet","marketName","parseInt","rid","post","REACT_APP_END_SURVEY_API","headers","timeLimit","count","setInterval","localEndTime","getLocalEndTime","localThankYou","toString","showBalancePopup","optionsData","option","onlyOpt","Array","prototype","concat","apply","subtotalArr","opt","totalSharesArr","parseFloat","reduce","p","c","toFixed","display","zIndex","color","height"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport SurveyHeader from \"./SurveyHeader\";\r\nimport { Spinner } from \"react-bootstrap\";\r\nimport SurveyData from \"./SurveyData\";\r\nimport SurveySidebar from \"./Sidebar/SurveySidebar\";\r\nimport AlertModal from \"./Modal/AlertModal\";\r\nimport InfoModal from \"./Modal/InfoModal\";\r\nimport Successful from \"../components/Successful\";\r\nimport { useLocation } from \"react-router\";\r\nimport { MarketOptiontype, MarketType } from \"../types\";\r\nimport { Howl, Howler } from \"howler\";\r\nimport toast from \"react-hot-toast\";\r\nimport axios from \"axios\";\r\nimport AlertSound from \"../assets/sounds/Alert.mp3\";\r\nimport useStickyState from \"../hooks/useStickyState\";\r\n\r\nconst Survey = () => {\r\n  const params = new URLSearchParams(useLocation().search);\r\n  const RID = params.get(\"RID\");\r\n\r\n  const [localSurveyData, setLocalSurveyData] = useStickyState(\r\n    [],\r\n    `survey_data${RID}`\r\n  );\r\n  const [localCartData] = useStickyState([], `cart_data${RID}`);\r\n  const [localThankYouPage, setLocalThankYouPage] = useStickyState(\r\n    false,\r\n    `thank_you_page${RID}`\r\n  );\r\n  const [localDefaultData] = useStickyState([], `default_data${RID}`);\r\n  const [, setLocalTimer] = useStickyState(0, `timer${RID}`);\r\n  const [localTimerCount, setLocalTimerCount] = useStickyState(\r\n    0,\r\n    `timer_count${RID}`\r\n  );\r\n  const [fetchedData, setFetchedData] = useState<any>([]);\r\n  const [, setDefaultData] = useState<MarketType[] | []>(localDefaultData);\r\n  const [surveyData, setSurveyData] = useState<MarketType[] | []>(\r\n    localSurveyData\r\n  );\r\n  const [cartData, setCartData] = useState<MarketType[] | []>(localCartData);\r\n  const [timer, setTimer] = useState<number>(0);\r\n  const [showThankyouPage, setShowThankyouPage] =\r\n    useState<boolean>(localThankYouPage);\r\n  const [toggleSidebar, setToggleSidebar] = useState<boolean>(false);\r\n  const [showWarning, setShowWarning] = useState<boolean>(false);\r\n  const [showInfoPopup, setShowInfoPopup] = useState<boolean>(false);\r\n  const [showTimerAlert, setShowTimerAlert] = useState<boolean>(false);\r\n  const [infoID, setInfoID] = useState<number>(0);\r\n  const [, setStartTime] = useState<any>();\r\n  const [, setEndTime] = useState<any>();\r\n  const [buttonLoading, setButtonLoading] = useState<boolean>(false);\r\n\r\n  sessionStorage.setItem(`userId${RID}`, RID!);\r\n\r\n  useEffect(() => {\r\n    showTimerPopUp();\r\n\r\n    if (localSurveyData.length === 0) {\r\n      let formData = new FormData();\r\n      formData.append(\"rid\", RID!);\r\n      fetch(process.env.REACT_APP_START_SURVEY_API!, {\r\n        method: \"post\",\r\n        body: formData,\r\n      })\r\n        .then((res) => res.json())\r\n        .then((data) => {\r\n          sessionStorage.setItem(\r\n            `endtime${RID}`,\r\n            JSON.stringify(\r\n              new Date(data.body[0].time_started).setTime(\r\n                new Date(data.body[0].time_started).getTime() + 600000\r\n              )\r\n            )\r\n          );\r\n          setFetchedData(data);\r\n          setStartTime(new Date(data.body[0].time_started).getTime());\r\n          setEndTime(\r\n            new Date(data.body[0].time_started).setTime(\r\n              new Date(data.body[0].time_started).getTime() + 600000\r\n            )\r\n          );\r\n        })\r\n        .catch((err) => toast.error(err?.message));\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (fetchedData.length === 0) {\r\n    } else if (fetchedData.message === \"rid is already used\") {\r\n      const lsd = sessionStorage.getItem(`survey_data${RID}`);\r\n      lsd !== null && setSurveyData(JSON.parse(localSurveyData));\r\n    } else {\r\n      let fetched_data = [\r\n        {\r\n          id: fetchedData.body[0].market1[0].id,\r\n          question: \"Which Kodiak product will sell the most?\",\r\n          subtotal: 0,\r\n          options: [\r\n            {\r\n              id: fetchedData.body[0].market1[0].option1.id,\r\n              name: \"Bacon, Egg and Cheese Biscuit Protein Breakfast Sandwich\",\r\n              price: fetchedData.body[0].market1[0].option1.price_1\r\n                ? fetchedData.body[0].market1[0].option1.price_1\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market1[0].option1.bet_1,\r\n              total: fetchedData.body[0].market1[0].option1.money_bet_1,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market1[0].option2.id,\r\n              name: \"Kids Chocolate Blueberry Power Waffle\",\r\n              price: fetchedData.body[0].market1[0].option2.price_2\r\n                ? fetchedData.body[0].market1[0].option2.price_2\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market1[0].option2.bet_2,\r\n              total: fetchedData.body[0].market1[0].option2.money_bet_2,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market1[0].option3.id,\r\n              name: \"High Protein Multi-Purpose Cake Flour\",\r\n              price: fetchedData.body[0].market1[0].option3.price_3\r\n                ? fetchedData.body[0].market1[0].option3.price_3\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market1[0].option3.bet_3,\r\n              total: fetchedData.body[0].market1[0].option3.money_bet_3,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market1[0].option4.id,\r\n              name: \"Protein Power To-Go Bars\",\r\n              price: fetchedData.body[0].market1[0].option4.price_4\r\n                ? fetchedData.body[0].market1[0].option4.price_4\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market1[0].option4.bet_4,\r\n              total: fetchedData.body[0].market1[0].option4.money_bet_4,\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          id: fetchedData.body[0].market2[0].id,\r\n          question: \"Who will be the host of Jeopardy! for the next season?\",\r\n          subtotal: 0,\r\n          options: [\r\n            {\r\n              id: fetchedData.body[0].market2[0].option1.id,\r\n              name: \"Ken Jennings\",\r\n              price: fetchedData.body[0].market2[0].option1.price_1\r\n                ? fetchedData.body[0].market2[0].option1.price_1\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market2[0].option1.bet_1,\r\n              total: fetchedData.body[0].market2[0].option1.money_bet_1,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market2[0].option2.id,\r\n              name: \"LaVar Burton\",\r\n              price: fetchedData.body[0].market2[0].option2.price_2\r\n                ? fetchedData.body[0].market2[0].option2.price_2\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market2[0].option2.bet_2,\r\n              total: fetchedData.body[0].market2[0].option2.money_bet_2,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market2[0].option3.id,\r\n              name: \"Aaron Rodgers\",\r\n              price: fetchedData.body[0].market2[0].option3.price_3\r\n                ? fetchedData.body[0].market2[0].option3.price_3\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market2[0].option3.bet_3,\r\n              total: fetchedData.body[0].market2[0].option3.money_bet_3,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market2[0].option4.id,\r\n              name: \"Somebody else\",\r\n              price: fetchedData.body[0].market2[0].option4.price_4\r\n                ? fetchedData.body[0].market2[0].option4.price_4\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market2[0].option4.bet_4,\r\n              total: fetchedData.body[0].market2[0].option4.money_bet_4,\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          id: fetchedData.body[0].market3[0].id,\r\n          question: \"How many games will BYU’s football team win?\",\r\n          subtotal: 0,\r\n          options: [\r\n            {\r\n              id: fetchedData.body[0].market3[0].option1.id,\r\n              name: \"6 or fewer\",\r\n              price: fetchedData.body[0].market3[0].option1.price_1\r\n                ? fetchedData.body[0].market3[0].option1.price_1\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market3[0].option1.bet_1,\r\n              total: fetchedData.body[0].market3[0].option1.money_bet_1,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market3[0].option2.id,\r\n              name: \"7\",\r\n              price: fetchedData.body[0].market3[0].option2.price_2\r\n                ? fetchedData.body[0].market3[0].option2.price_2\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market3[0].option2.bet_2,\r\n              total: fetchedData.body[0].market3[0].option2.money_bet_2,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market3[0].option3.id,\r\n              name: \"8\",\r\n              price: fetchedData.body[0].market3[0].option3.price_3\r\n                ? fetchedData.body[0].market3[0].option3.price_3\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market3[0].option3.bet_3,\r\n              total: fetchedData.body[0].market3[0].option3.money_bet_3,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market3[0].option4.id,\r\n              name: \"9 or more\",\r\n              price: fetchedData.body[0].market3[0].option4.price_4\r\n                ? fetchedData.body[0].market3[0].option4.price_4\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market3[0].option4.bet_4,\r\n              total: fetchedData.body[0].market3[0].option4.money_bet_4,\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          id: fetchedData.body[0].market4[0].id,\r\n          question:\r\n            \"Will upcoming James Bond film “No Time To Die” be “Certified Fresh” by Rotten Tomatoes?\",\r\n          subtotal: 0,\r\n          options: [\r\n            {\r\n              id: fetchedData.body[0].market4[0].option1.id,\r\n              name: \"Yes\",\r\n              price: fetchedData.body[0].market4[0].option1.price_1\r\n                ? fetchedData.body[0].market4[0].option1.price_1\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market4[0].option1.bet_1,\r\n              total: fetchedData.body[0].market4[0].option1.money_bet_1,\r\n            },\r\n            {\r\n              id: fetchedData.body[0].market4[0].option2.id,\r\n              name: \"No\",\r\n              price: fetchedData.body[0].market4[0].option2.price_2\r\n                ? fetchedData.body[0].market4[0].option2.price_2\r\n                : 0.0,\r\n              quantity: fetchedData.body[0].market4[0].option2.bet_2,\r\n              total: fetchedData.body[0].market4[0].option2.money_bet_2,\r\n            },\r\n          ],\r\n        },\r\n      ];\r\n\r\n      const shuffle = () => {\r\n        return fetched_data.sort(() => Math.random() - 0.5);\r\n      };\r\n\r\n      const shuffled_fetched_data = shuffle();\r\n\r\n      setDefaultData(shuffled_fetched_data);\r\n      setSurveyData(shuffled_fetched_data);\r\n\r\n      if (shuffled_fetched_data.length > 0) {\r\n        sessionStorage.setItem(\r\n          `default_data${RID}`,\r\n          JSON.stringify(shuffled_fetched_data)\r\n        );\r\n      }\r\n      setLocalSurveyData(JSON.stringify(shuffled_fetched_data));\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [fetchedData, setFetchedData]);\r\n\r\n  sessionStorage.setItem(`survey_data${RID}`, JSON.stringify(surveyData));\r\n  sessionStorage.setItem(`userId${RID}`, JSON.stringify(RID));\r\n  sessionStorage.setItem(`cart_data${RID}`, JSON.stringify(cartData));\r\n\r\n  let totalPurchase;\r\n  let totalShares;\r\n\r\n  const playNotification = () => {\r\n    Howler.volume(1.0);\r\n    const sound = new Howl({\r\n      src: [AlertSound],\r\n      autoplay: true,\r\n    });\r\n    sound.play();\r\n  };\r\n\r\n  const submitData = () => {\r\n    setToggleSidebar(true);\r\n    const l_cart_data = sessionStorage.getItem(`cart_data${RID}`);\r\n\r\n    if (l_cart_data !== null && JSON.parse(l_cart_data).length !== 0) {\r\n      const parse_l_cart_data = JSON.parse(l_cart_data);\r\n      let convertedData = {};\r\n      const marketIDs = parse_l_cart_data.map((market: any) => market.id);\r\n      let marketData = [];\r\n\r\n      for (let d in marketIDs) {\r\n        let oneMarketData = surveyData?.find((obj) => obj.id === marketIDs[d]);\r\n        marketData.push(oneMarketData);\r\n      }\r\n\r\n      let marketDataOptions = marketData.map((market: any) => market?.options);\r\n\r\n      for (let d in marketData) {\r\n        const optId = marketDataOptions[d].map((m: any) => m.id);\r\n        const optBet = marketDataOptions[d].map((m: any) => m.quantity);\r\n        const optPrice = marketDataOptions[d].map((m: any) => m.price);\r\n        let opts: any = [];\r\n        for (let i in optId) {\r\n          opts = [\r\n            ...opts,\r\n            {\r\n              id: optId[i],\r\n              bet: optBet[i],\r\n              price: optPrice[i],\r\n            },\r\n          ];\r\n        }\r\n        let marketName = `market${parseInt(d) + 1}`;\r\n        convertedData = {\r\n          ...convertedData,\r\n          [marketName]: {\r\n            id: marketIDs[d],\r\n            options: opts,\r\n          },\r\n        };\r\n      }\r\n\r\n      convertedData = {\r\n        ...convertedData,\r\n        rid: RID,\r\n      };\r\n\r\n      axios\r\n        .post(\r\n          process.env.REACT_APP_END_SURVEY_API!,\r\n          JSON.stringify(convertedData),\r\n          {\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n          }\r\n        )\r\n        .then((res: any) => {\r\n          if (res?.data?.message === \"success\") {\r\n            setShowThankyouPage(true);\r\n            setLocalThankYouPage(true);\r\n          } else {\r\n            toast.error(res?.data?.message);\r\n          }\r\n          setButtonLoading(false);\r\n        })\r\n        .catch((err) => {\r\n          toast.error(err?.message);\r\n          setButtonLoading(false);\r\n        });\r\n    }\r\n  };\r\n\r\n  const showTimerPopUp = () => {\r\n    if (surveyData) {\r\n      const timeLimit = 480;\r\n\r\n      let i;\r\n      let count = localTimerCount;\r\n      const timer = setInterval(() => {\r\n        const localEndTime = sessionStorage.getItem(`endtime${RID}`);\r\n        const getLocalEndTime =\r\n          localEndTime !== null && JSON.parse(localEndTime);\r\n        const localThankYou = sessionStorage.getItem(`thank_you_page${RID}`);\r\n        i = parseInt(\r\n          (600 - (getLocalEndTime - new Date().getTime()) / 1000).toString()\r\n        );\r\n        if (\r\n          i === timeLimit &&\r\n          count === 0 &&\r\n          localThankYou !== null &&\r\n          !JSON.parse(localThankYou)\r\n        ) {\r\n          count++;\r\n          setLocalTimerCount(count);\r\n          setShowTimerAlert(true);\r\n          setShowWarning(true);\r\n          playNotification();\r\n        }\r\n        setTimer(i);\r\n        setLocalTimer(JSON.stringify(i));\r\n      }, 1000);\r\n    }\r\n  };\r\n\r\n  const showBalancePopup = () => {\r\n    setShowTimerAlert(false);\r\n    setShowWarning(true);\r\n    playNotification();\r\n  };\r\n\r\n  if (cartData) {\r\n    const optionsData = cartData.map((market) => market.options);\r\n    optionsData.map((option) => option);\r\n    const onlyOpt: MarketOptiontype[] = Array.prototype.concat.apply(\r\n      [],\r\n      optionsData.map((option) => option)\r\n    );\r\n    const subtotalArr = onlyOpt.map((opt) => opt.total);\r\n    const totalSharesArr = onlyOpt.map((opt) => opt.quantity);\r\n\r\n    totalPurchase = parseFloat(\r\n      subtotalArr.reduce((p, c) => p + c, 0).toFixed(2)\r\n    );\r\n    totalShares = totalSharesArr.reduce((p, c) => p + c, 0);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {!localThankYouPage && (\r\n        <div\r\n          className=\"app_background_overlay\"\r\n          onClick={() => setToggleSidebar(false)}\r\n          style={{ display: toggleSidebar ? \"block\" : \"none\", zIndex: 9 }}\r\n        />\r\n      )}\r\n      <div className=\"survey\">\r\n        {surveyData.length !== 0 ? (\r\n          <>\r\n            <AlertModal\r\n              showWarning={showWarning}\r\n              setShowWarning={setShowWarning}\r\n              type={showTimerAlert ? \"time\" : \"balance\"}\r\n              timer={timer}\r\n              toggleSidebar={toggleSidebar}\r\n              setToggleSidebar={setToggleSidebar}\r\n            />\r\n            <InfoModal\r\n              showInfoPopup={showInfoPopup}\r\n              setShowInfoPopup={setShowInfoPopup}\r\n              surveyData={surveyData}\r\n              infoID={infoID}\r\n            />\r\n            {!showThankyouPage ? (\r\n              <>\r\n                <SurveySidebar\r\n                  totalShares={totalShares}\r\n                  totalPurchase={totalPurchase}\r\n                  surveyData={surveyData}\r\n                  setSurveyData={setSurveyData}\r\n                  cartData={cartData}\r\n                  setCartData={setCartData}\r\n                  toggleSidebar={toggleSidebar}\r\n                  setToggleSidebar={setToggleSidebar}\r\n                  setShowThankyouPage={setShowThankyouPage}\r\n                  submitData={submitData}\r\n                  timer={timer}\r\n                  setButtonLoading={setButtonLoading}\r\n                  buttonLoading={buttonLoading}\r\n                />\r\n                <SurveyHeader\r\n                  totalPurchase={totalPurchase}\r\n                  toggleSidebar={toggleSidebar}\r\n                  setToggleSidebar={setToggleSidebar}\r\n                  timer={timer}\r\n                />\r\n                <p\r\n                  className=\"text-center font-italic my-2\"\r\n                  style={{ color: \"#727272\" }}\r\n                >\r\n                  <em>Tap an option to purchase a share</em>\r\n                </p>\r\n                <SurveyData\r\n                  showBalancePopup={showBalancePopup}\r\n                  totalPurchase={totalPurchase}\r\n                  surveyData={surveyData}\r\n                  setSurveyData={setSurveyData}\r\n                  cartData={cartData}\r\n                  setCartData={setCartData}\r\n                  showInfoPopup={showInfoPopup}\r\n                  setShowInfoPopup={setShowInfoPopup}\r\n                  setInfoID={setInfoID}\r\n                  infoID={infoID}\r\n                />\r\n              </>\r\n            ) : (\r\n              <div\r\n                className=\"d-flex justify-content-center align-items-center w-100\"\r\n                style={{ height: \"100vh\" }}\r\n              >\r\n                <Successful />\r\n              </div>\r\n            )}\r\n          </>\r\n        ) : (\r\n          <div\r\n            className=\"d-flex justify-content-center align-items-center w-100\"\r\n            style={{ height: \"100vh\" }}\r\n          >\r\n            <Spinner animation=\"border\" />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Survey;\r\n"]},"metadata":{},"sourceType":"module"}